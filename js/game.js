var bg1=new Image;bg1.src="../images/space.jpg";var bg2=new Image;bg2.src="../images/space.jpg";var bgY1=0,bgY2=-800,ship1=new Image,ship2=new Image,ship3=new Image,ship4=new Image;ship1.src="../images/gunship4.png",ship2.src="../images/gunship5.png",ship3.src="../images/gunship6.png",ship4.src="../images/gunship7.png";var enemyShip1=new Image,enemyShip2=new Image,enemyShip3=new Image,enemyShip4=new Image;enemyShip1.src="../images/gunship0.png",enemyShip2.src="../images/gunship1.png",enemyShip3.src="../images/gunship2.png",enemyShip4.src="../images/gunship3.png";var enemyShip11=new Image,enemyShip12=new Image,enemyShip13=new Image,enemyShip14=new Image;enemyShip11.src="../images/gunship11.png",enemyShip12.src="../images/gunship12.png",enemyShip13.src="../images/gunship13.png",enemyShip14.src="../images/gunship14.png";var enemyShip21=new Image,enemyShip22=new Image,enemyShip23=new Image,enemyShip24=new Image;enemyShip21.src="../images/gunship21.png",enemyShip22.src="../images/gunship22.png",enemyShip23.src="../images/gunship23.png",enemyShip24.src="../images/gunship24.png";var missile=new Image;missile.src="../images/missile1.png";var ctx,canvas,fireSound=new Audio("../sounds/fire2.wav"),bgm=new Audio("../sounds/Burning_Body.mp3"),counter=0,shipX=250,shipY=700,enemyShipX=Math.floor(550*Math.random()),enemyShipY=50,missileX=-250,missileY=-250,missileArray=[],enemyArray=[],score=0,isGameOver=!1;function resetGame(e){if(isGameOver&&88==e.keyCode){isGameOver=!1,canvas.onmousemove=moveShip,canvas.onmousedown=fireMissile,shipX=250,shipY=500,score=0;for(var n=0;enemyArray.length;n++)enemyArray[n].y=1001}}function drawScreen(){counter++,(bgY1+=3)>=800&&(bgY1=-800),(bgY2+=3)>=800&&(bgY2=-800),ctx.drawImage(bg1,0,bgY1,600,800),ctx.drawImage(bg2,0,bgY2,600,800),counter%4==0?ctx.drawImage(ship1,shipX,shipY,50,50):counter%4==1?ctx.drawImage(ship2,shipX,shipY,50,50):counter%4==2?ctx.drawImage(ship3,shipX,shipY,50,50):counter%4==3&&ctx.drawImage(ship4,shipX,shipY,50,50);for(var e=0;e<enemyArray.length;e++)1==enemyArray[e].type?counter%4==0?ctx.drawImage(enemyShip1,enemyArray[e].x,enemyArray[e].y,50,50):counter%4==1?ctx.drawImage(enemyShip2,enemyArray[e].x,enemyArray[e].y,50,50):counter%4==2?ctx.drawImage(enemyShip3,enemyArray[e].x,enemyArray[e].y,50,50):counter%4==3&&ctx.drawImage(enemyShip4,enemyArray[e].x,enemyArray[e].y,50,50):2==enemyArray[e].type?counter%4==0?ctx.drawImage(enemyShip11,enemyArray[e].x,enemyArray[e].y,50,50):counter%4==1?ctx.drawImage(enemyShip12,enemyArray[e].x,enemyArray[e].y,50,50):counter%4==2?ctx.drawImage(enemyShip13,enemyArray[e].x,enemyArray[e].y,50,50):counter%4==3&&ctx.drawImage(enemyShip14,enemyArray[e].x,enemyArray[e].y,50,50):3==enemyArray[e].type&&(counter%4==0?ctx.drawImage(enemyShip21,enemyArray[e].x,enemyArray[e].y,100,100):counter%4==1?ctx.drawImage(enemyShip22,enemyArray[e].x,enemyArray[e].y,100,100):counter%4==2?ctx.drawImage(enemyShip23,enemyArray[e].x,enemyArray[e].y,100,100):counter%4==3&&ctx.drawImage(enemyShip24,enemyArray[e].x,enemyArray[e].y,100,100)),enemyArray[e].y+=3,enemyArray[e].y>=1e3&&enemyArray.shift();for(e=0;e<missileArray.length;e++)ctx.drawImage(missile,missileArray[e].x,missileArray[e].y,5,20),missileArray[e].y-=3,missileArray[e].y<0&&missileArray.shift();checkCollision(),checkShipCollision(),ctx.fillStyle="blue",ctx.font="35px 고딕",ctx.fillText("SCORE : "+score,200,50),isGameOver&&(ctx.font="90px 고딕",ctx.fillText("GAME OVER",50,300),ctx.font="30px 고딕",ctx.fillText("Please Insert Coin",150,400))}function checkShipCollision(){for(var e=0;e<enemyArray.length;e++){var n=enemyArray[e];pythagoras(shipX,shipY,n.x,n.y)<40&&gameOver()}}function gameOver(){canvas.onmousemove="",canvas.onmousedown="",isGameOver=!0}function moveShip(e){shipX=e.pageX-25,shipY=e.pageY-25}function fireMissile(e){fireSound.currentTime=0,fireSound.volume=.01,fireSound.play();var n={x:e.pageX,y:e.pageY};missileArray.push(n)}function startBGMOn(){bgm.currentTime=0,bgm.volume=.02,bgm.play()}function stopBGMOff(){bgm.pause()}function makeEnemy(){var e=Math.floor(550*Math.random()),n=Math.floor(3*Math.random())+1,r={x:e,y:50,type:n,hp:100*n};enemyArray.push(r)}function pythagoras(e,n,r,a){return Math.sqrt((r-e)*(r-e)+(a-n)*(a-n))}function checkCollision(){for(var e=0;e<enemyArray.length;e++)for(var n=enemyArray[e],r=0;r<missileArray.length;r++){var a=missileArray[r];pythagoras(a.x,a.y,n.x,n.y)<40&&(n.y-=50,a.y=-10,n.hp-=100,n.hp<=0&&(n.x+=1e3,score+=100*n.type))}}window.onload=function(){canvas=document.getElementById("myCanvas"),ctx=canvas.getContext("2d"),window.setInterval(drawScreen,10),window.setInterval(makeEnemy,500),document.body.onkeydown=resetGame,canvas.onmousemove=moveShip,canvas.onmousedown=fireMissile};